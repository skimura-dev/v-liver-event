<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTMLã‚³ãƒ¼ãƒ‰ç”Ÿæˆãƒ„ãƒ¼ãƒ«</title>
    <style>
        body { font-family: sans-serif; background: #f4f4f4; padding: 20px; }
        h1 { text-align: center; font-size: 20px; }
        
        .container { display: flex; gap: 20px; }
        .column { flex: 1; background: white; padding: 15px; border-radius: 8px; border-top: 5px solid #ccc; }
        .red { border-color: #ff4d4d; } .blue { border-color: #4d79ff; } .yellow { border-color: #ffcc00; }

        .drop-zone {
            border: 3px dashed #ccc; padding: 20px; text-align: center; background: #fafafa;
            color: #888; border-radius: 8px; margin-bottom: 15px; cursor: pointer;
        }
        .drop-zone.dragover { background: #eef; border-color: #4d79ff; }

        /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒªã‚¹ãƒˆ */
        .preview-list { max-height: 200px; overflow-y: auto; border: 1px solid #eee; margin-bottom: 10px; }
        .item { display: flex; align-items: center; padding: 5px; border-bottom: 1px solid #eee; font-size: 12px; }
        .item img { width: 30px; height: 30px; object-fit: cover; margin-right: 5px; border-radius: 50%; }
        .item input { flex: 1; border: 1px solid #ddd; padding: 2px; margin-left: 5px; }

        /* ã‚³ãƒ¼ãƒ‰å‡ºåŠ›ã‚¨ãƒªã‚¢ */
        textarea { width: 100%; height: 150px; font-family: monospace; font-size: 11px; background: #222; color: #0f0; border: none; padding: 10px; box-sizing: border-box; }
        .copy-btn { width: 100%; padding: 10px; background: #333; color: white; border: none; cursor: pointer; margin-top: 5px; }
        .copy-btn:hover { background: #555; }
    </style>
</head>
<body>

    <h1>STEP 2: HTMLç”Ÿæˆãƒ„ãƒ¼ãƒ«</h1>
    <p style="text-align:center; font-size:12px;">ç”»åƒã‚’ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦ãƒªã‚¹ãƒˆã‚’ä½œã‚Šã€ã€Œã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã€â†’ã€Œã‚³ãƒ”ãƒ¼ã€ã—ã¦ã€å„htmlãƒ•ã‚¡ã‚¤ãƒ«ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚</p>

    <div class="container">
        <script>
            const teams = ['red', 'blue', 'yellow'];
            teams.forEach(color => {
                document.write(`
                    <div class="column ${color}">
                        <h2 style="text-transform:uppercase; text-align:center;">${color}</h2>
                        
                        <div class="drop-zone" id="drop-${color}">
                            ç”»åƒã‚’ã“ã“ã«ãƒ‰ãƒ­ãƒƒãƒ—<br>
                            <small>images/${color}/ å†…ã®ç”»åƒ</small>
                        </div>
                        
                        <div class="preview-list" id="list-${color}"></div>
                        
                        <button class="copy-btn" onclick="generateCode('${color}')">â–¼ ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆãƒ»æ›´æ–°</button>
                        <textarea id="code-${color}" readonly placeholder="ã“ã“ã«HTMLã‚³ãƒ¼ãƒ‰ãŒå‡ºã¾ã™"></textarea>
                        <button class="copy-btn" onclick="copyText('${color}')">ğŸ“‹ ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼</button>
                    </div>
                `);
            });
        </script>
    </div>

<script>
    const dataStore = { red: [], blue: [], yellow: [] };

    window.onload = function() {
        teams.forEach(color => setupDropZone(color));
    };

    function setupDropZone(color) {
        const zone = document.getElementById('drop-' + color);
        zone.addEventListener('dragover', e => { e.preventDefault(); zone.classList.add('dragover'); });
        zone.addEventListener('dragleave', e => { e.preventDefault(); zone.classList.remove('dragover'); });
        zone.addEventListener('drop', e => {
            e.preventDefault(); zone.classList.remove('dragover');
            handleFiles(color, e.dataTransfer.files);
        });
    }

    function handleFiles(color, files) {
        Array.from(files).forEach(file => {
            if (!file.type.startsWith('image/')) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                // ãƒ•ã‚¡ã‚¤ãƒ«åã‹ã‚‰åå‰ã‚’æ¨æ¸¬
                const cleanName = file.name.replace(/\.[^/.]+$/, "");
                dataStore[color].push({
                    name: cleanName,
                    filename: file.name, // æœ¬ç•ªç”¨ã®ãƒ‘ã‚¹ç”Ÿæˆã«ä½¿ã†
                    preview: e.target.result // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºç”¨
                });
                renderList(color);
            };
            reader.readAsDataURL(file);
        });
    }

    function renderList(color) {
        const list = document.getElementById('list-' + color);
        list.innerHTML = '';
        dataStore[color].forEach((item, idx) => {
            const div = document.createElement('div');
            div.className = 'item';
            div.innerHTML = `
                <img src="${item.preview}">
                <input value="${item.name}" oninput="dataStore['${color}'][${idx}].name = this.value">
                <button onclick="removeItem('${color}', ${idx})">Ã—</button>
            `;
            list.appendChild(div);
        });
    }

    function removeItem(color, idx) {
        dataStore[color].splice(idx, 1);
        renderList(color);
    }

    // â˜…ã“ã“ãŒé‡è¦ï¼šHTMLã‚³ãƒ¼ãƒ‰ã‚’ä½œã‚‹éƒ¨åˆ†â˜…
    function generateCode(color) {
        let html = '';
        dataStore[color].forEach(item => {
            // ç”»åƒãƒ‘ã‚¹ã¯ "images/red/ãƒ•ã‚¡ã‚¤ãƒ«å" ã«ãªã‚‹ã‚ˆã†ã«ã™ã‚‹
            const imgPath = `images/${color}/${item.filename}`;
            
            html += `
            <div class="member-card">
                <a href="#" class="member-link" target="_blank">
                    <div class="member-img">
                        <img src="${imgPath}" alt="${item.name}">
                    </div>
                    <h3 class="member-name">${item.name}</h3>
                </a>
            </div>\n`;
        });
        document.getElementById('code-' + color).value = html;
    }

    function copyText(color) {
        const textarea = document.getElementById('code-' + color);
        textarea.select();
        document.execCommand('copy');
        alert(color + 'ãƒãƒ¼ãƒ ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼\n' + color + '.html ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚');
    }
</script>

</body>
</html>